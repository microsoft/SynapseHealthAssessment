CREATE VIEW dbo.V_MS_STATS_COLUMNS AS
SELECT
	sm.[name]	AS [schema_name]
,	tb.[name]	AS [table_name]
,	st.[name]	AS [stats_name]
,	st.[filter_definition]	AS [stats_filter_definition]
,	st.[has_filter]	AS [stats_is_filtered]
,	st.[user_created]
,	STATS_DATE(st.[object_id],st.[stats_id])
AS [stats_last_updated_date]
,	co.[name]	AS [stats_column_name]
,	ty.[name]	AS [column_type]
,	co.[max_length]	AS [column_max_length]
,	co.[precision]	AS [column_precision]
,	co.[scale]	AS [column_scale]
,	co.[is_nullable]	AS [column_is_nullable]
,	co.[collation_name]	AS [column_collation_name]
,	QUOTENAME(sm.[name])+'.'+QUOTENAME(tb.[name])
AS two_part_name
,	QUOTENAME(DB_NAME())+'.'+QUOTENAME(sm.[name])+'.'+QUOTENAME(tb.[name])
AS three_part_name
FROM   sys.objects	AS ob
JOIN   sys.stats	AS st ON   ob.[object_id]	= st.[object_id] JOIN    sys.stats_columns   AS sc ON   st.[stats_id]		= sc.[stats_id]
AND	st.[object_id]	= sc.[object_id]
JOIN   sys.columns	AS co ON   sc.[column_id]	= co.[column_id] AND		sc.[object_id]	= co.[object_id]
JOIN   sys.types	AS ty ON co.[user_type_id] = ty.[user_type_id] JOIN   sys.tables	AS tb ON co.[object_id]	= tb.[object_id]
JOIN   sys.schemas	AS sm ON tb.[schema_id]	= sm.[schema_id] WHERE 1=1


SELECT * FROM V_MS_STATS_COLUMNS
